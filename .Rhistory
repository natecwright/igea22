#
#
#
# unique(pCode$parameter_units)
library(dataRetrieval)
library(tidyverse)
library(lubridate)
library(cowplot)
## download some example data
site <- "09010500"
discharge <- readNWISuv(siteNumbers = site,
parameterCd = "00060",
startDate = "2013-01-01",
endDate = "2021-01-01")
discharge <- renameNWISColumns(discharge)%>%
mutate(flow_Inst_2 = Flow_Inst*.0283168)
precip <- readNWISuv(siteNumbers = site,
parameterCd = "00045",
startDate = "2022-05-17",
endDate = "2022-10-01")
precip <-renameNWISColumns(precip)%>%
mutate(precip_2 = x_00045_00000*25.4)
# library(dataRetrieval)
# # Choptank River near Greensboro, MD
# siteNumber <- "15908000"
# ChoptankInfo <- readNWISsite(siteNumber)
# parameterCd <- "00060"
#
# # Raw daily data:
# rawDailyData <- readNWISdv(
#   siteNumber, parameterCd,
#   "2013-01-01", "2021-01-01"
# )
#
# pCode <- readNWISpCode(parameterCd)
#
#
#
# unique(pCode$parameter_units)
library(dataRetrieval)
library(tidyverse)
library(lubridate)
library(cowplot)
## download some example data
site <- "09010500"
discharge <- readNWISuv(siteNumbers = site,
parameterCd = "00060",
startDate = "2013-01-01",
endDate = "2021-01-01")
discharge <- renameNWISColumns(discharge)%>%
mutate(flow_Inst_2 = Flow_Inst*.0283168)
precip <- readNWISuv(siteNumbers = site,
parameterCd = "00045",
startDate = "2022-05-17",
endDate = "2022-10-01")
precip <-renameNWISColumns(precip)
names(precip)[4] <- 'precip'
mutate(precip_2 = x_00045_00000*25.4)
library(dataRetrieval)
library(tidyverse)
library(lubridate)
library(cowplot)
## download some example data
site <- "09010500"
discharge <- readNWISuv(siteNumbers = site,
parameterCd = "00060",
startDate = "2013-01-01",
endDate = "2021-01-01")
discharge <- renameNWISColumns(discharge)%>%
mutate(flow_Inst_2 = Flow_Inst*.0283168)
precip <- readNWISuv(siteNumbers = site,
parameterCd = "00045",
startDate = "2022-05-17",
endDate = "2022-10-01")
precip <-renameNWISColumns(precip)
p1 <- ggplot(joined_data) +
geom_line(aes(dateTime, Flow_Inst_2, color = "Discharge")) +
scale_y_continuous(position = "left",
limits = c(0, 1000),
expand = c(0,0)) +
scale_color_manual(values = c("steelblue")) +
guides(x = guide_axis(angle = 90)) +
labs(y = "Discharge [cms]",
x = "Date")
source("~/Documents/senior_year/hydrology/Untitled.R", echo=TRUE)
p1
p1 <- ggplot(joined_data) +
geom_line(aes(dateTime, flow_Inst_2, color = "Discharge")) +
scale_y_continuous(position = "left",
limits = c(0, 1000),
expand = c(0,0)) +
scale_color_manual(values = c("steelblue")) +
guides(x = guide_axis(angle = 90)) +
labs(y = "Discharge [cms]",
x = "Date")
p1
p1 <- ggplot(joined_data) +
geom_line(aes(dateTime, flow_Inst_2, color = "Discharge")) +
scale_y_continuous(position = "left",
limits = c(0, 100),
expand = c(0,0)) +
scale_color_manual(values = c("steelblue")) +
guides(x = guide_axis(angle = 90)) +
labs(y = "Discharge [cms]",
x = "Date")
p1
p1 <- ggplot(joined_data) +
geom_line(aes(dateTime, flow_Inst_2, color = "Discharge")) +
scale_y_continuous(position = "left",
limits = c(0, 35),
expand = c(0,0)) +
scale_color_manual(values = c("steelblue")) +
guides(x = guide_axis(angle = 90)) +
labs(y = "Discharge [cms]",
x = "Date")
p1
p1 <- ggplot(joined_data) +
geom_line(aes(dateTime, flow_Inst_2, color = "Discharge")) +
scale_y_continuous(position = "left",
limits = c(0, 35),
expand = c(0,0)) +
scale_color_manual(values = c("steelblue")) +
guides(x = guide_axis(angle = 90)) +
ggtitle("COLORADO RIVER BELOW BAKER GULCH NR GRAND LAKE, CO")
labs(y = "Discharge [cms]",
x = "Date") +
theme(plot.title) = element_text()
p1 <- ggplot(joined_data) +
geom_line(aes(dateTime, flow_Inst_2, color = "Discharge")) +
scale_y_continuous(position = "left",
limits = c(0, 35),
expand = c(0,0)) +
scale_color_manual(values = c("steelblue")) +
guides(x = guide_axis(angle = 90)) +
ggtitle("COLORADO RIVER BELOW BAKER GULCH NR GRAND LAKE, CO")
labs(y = "Discharge [cms]",
x = "Date") +
p1 <- ggplot(joined_data) +
geom_line(aes(dateTime, flow_Inst_2, color = "Discharge")) +
scale_y_continuous(position = "left",
limits = c(0, 35),
expand = c(0,0)) +
scale_color_manual(values = c("steelblue")) +
guides(x = guide_axis(angle = 90)) +
ggtitle("COLORADO RIVER BELOW BAKER GULCH NR GRAND LAKE, CO")
p1 <- ggplot(joined_data) +
geom_line(aes(dateTime, flow_Inst_2, color = "Discharge")) +
scale_y_continuous(position = "left",
limits = c(0, 35),
expand = c(0,0)) +
scale_color_manual(values = c("steelblue")) +
guides(x = guide_axis(angle = 90)) +
ggtitle("COLORADO RIVER BELOW BAKER GULCH NR GRAND LAKE, CO") +
labs(y = "Discharge [cms]",
x = "Date")
p1
source("~/.active-rstudio-document", echo=TRUE)
p1
discharge <- readNWISuv(siteNumbers = site,
parameterCd = "00060",
startDate = "2013-12-01",
endDate = "2015-01-01")
discharge <- renameNWISColumns(discharge)%>%
mutate(flow_Inst_2 = Flow_Inst*.0283168)
p1
source("~/.active-rstudio-document", echo=TRUE)
p1
discharge <- readNWISuv(siteNumbers = site,
parameterCd = "00060",
startDate = "2011-11-01",
endDate = "2015-01-01")
discharge <- renameNWISColumns(discharge)%>%
mutate(flow_Inst_2 = Flow_Inst*.0283168)
precip <- readNWISuv(siteNumbers = site,
parameterCd = "00045",
startDate = "2022-05-17",
endDate = "2022-10-01")
precip <-renameNWISColumns(precip)
#names(precip)[4] <- 'precip'
p1
source("~/.active-rstudio-document", echo=TRUE)
View(discharge)
p1
source("~/.active-rstudio-document", echo=TRUE)
p1
discharge <- readNWISuv(siteNumbers = site,
parameterCd = "00060",
startDate = "2013-10-01",
endDate = "2015-01-01")
discharge <- renameNWISColumns(discharge)%>%
mutate(flow_Inst_2 = Flow_Inst*.0283168)
precip <- readNWISuv(siteNumbers = site,
parameterCd = "00045",
startDate = "2022-05-17",
endDate = "2022-10-01")
precip <-renameNWISColumns(precip)
#names(precip)[4] <- 'precip'
p1
## download some example data
site <- "09010500"
discharge <- readNWISuv(siteNumbers = site,
parameterCd = "00060",
startDate = "2013-06-01",
endDate = "2015-01-01")
discharge <- renameNWISColumns(discharge)%>%
mutate(flow_Inst_2 = Flow_Inst*.0283168)
p`1`
p1
site <- "09010500"
discharge <- readNWISuv(siteNumbers = site,
parameterCd = "00060",
startDate = "2013-03-01",
endDate = "2015-01-01")
discharge <- renameNWISColumns(discharge)%>%
mutate(flow_Inst_2 = Flow_Inst*.0283168)
precip <- readNWISuv(siteNumbers = site,
parameterCd = "00045",
startDate = "2022-05-17",
endDate = "2022-10-01")
precip <-renameNWISColumns(precip)
p1
## download some example data
site <- "09010500"
discharge <- readNWISuv(siteNumbers = site,
parameterCd = "00060",
startDate = "2013-01-07",
endDate = "2015-01-01")
discharge <- renameNWISColumns(discharge)%>%
mutate(flow_Inst_2 = Flow_Inst*.0283168)
p1
View(discharge)
source("~/.active-rstudio-document", echo=TRUE)
p1
source("~/.active-rstudio-document", echo=TRUE)
p1
source("~/.active-rstudio-document", echo=TRUE)
p1
source("~/.active-rstudio-document", echo=TRUE)
p1
p1 <- ggplot(joined_data) +
geom_line(aes(dateTime, flow_Inst_2, color = "Discharge")) +
scale_y_continuous(position = "left",
limits = c(0, 35),
expand = c(0,0)) +
scale_color_manual(values = c("steelblue")) +
guides(x = guide_axis(angle = 90)) +
ggtitle("COLORADO RIVER BELOW BAKER GULCH NR GRAND LAKE, CO") +
labs(y = "Discharge [cms]",
x = "Date (10-2013 to 10-2014")
p1
p1 <- ggplot(joined_data) +
geom_line(aes(dateTime, flow_Inst_2, color = "Discharge")) +
scale_y_continuous(position = "left",
limits = c(0, 35),
expand = c(0,0)) +
scale_color_manual(values = c("steelblue")) +
guides(x = guide_axis(angle = 90)) +
ggtitle("COLORADO RIVER BELOW BAKER GULCH NR GRAND LAKE, CO") +
labs(y = "Discharge [cms]",
x = "Date (10-2013 to 10-2014)")
p1
X = c(.1,.2,.1,.4,.5,.1,.1,.1,.2,.1) #weighing coefficient
d = c(1,4,4,7,6,7,7,14,15,20) #m
K = 1000/sqrt(9.81*d) #
I = c(100,120,140,150,150,160,130,120,110,100) #m3/s
delt = 1 #day
Q = 100
t = c(1,2,3,4,5,6,7,8,9,10)
i = seq(100:1000, by=100)
X = c(.1,.2,.1,.4,.5,.1,.1,.1,.2,.1) #weighing coefficient
d = c(1,4,4,7,6,7,7,14,15,20) #m
K = 1000/sqrt(9.81*d) #
# I = c(100,120,140,150,150,160,130,120,110,100) #m3/s
delt = 1 #day
Q = 100
t = c(1,2,3,4,5,6,7,8,9,10)
# i = seq(100,1000, by=100)
for (i in 1:9) {
for (j in 1:9) {
C1 = (delt-2*K*X)/(2*K*(1-X)+delt)
C2 = (delt+2*K*X)/(2*K*(1-X)+delt)
C3 = (2*K*(1-X)-delt)/(2*k*(1-X)+delt)
Q[i+1,j+1]=C1[i]*Q[i,j+1]+C2[i]*Q[i,j]+C3[i]Q[i+1,j]
X = c(.1,.2,.1,.4,.5,.1,.1,.1,.2,.1) #weighing coefficient
d = c(1,4,4,7,6,7,7,14,15,20) #m
K = 1000/sqrt(9.81*d) #
# I = c(100,120,140,150,150,160,130,120,110,100) #m3/s
delt = 1 #day
Q = 100
t = c(1,2,3,4,5,6,7,8,9,10)
# i = seq(100,1000, by=100)
for (i in 1:9) {
for (j in 1:9) {
C1 = (delt-2*K*X)/(2*K*(1-X)+delt)
C2 = (delt+2*K*X)/(2*K*(1-X)+delt)
C3 = (2*K*(1-X)-delt)/(2*k*(1-X)+delt)
Q[i+1,j+1]=C1[i]*Q[i,j+1]+C2[i]*Q[i,j]+C3[i]*Q[i+1,j]
}
}
X = c(.1,.2,.1,.4,.5,.1,.1,.1,.2,.1) #weighing coefficient
d = c(1,4,4,7,6,7,7,14,15,20) #m
K = 1000/sqrt(9.81*d) #
I = c(100,120,140,150,150,160,130,120,110,100) #m3/s
delt = 1 #day
Q = 100
t = c(1,2,3,4,5,6,7,8,9,10)
# i = seq(100,1000, by=100)
C1 = (delt-2*K*X)/(2*K*(1-X)+delt)
C2 = (delt+2*K*X)/(2*K*(1-X)+delt)
C3 = (2*K*(1-X)-delt)/(2*k*(1-X)+delt)
X = c(.1,.2,.1,.4,.5,.1,.1,.1,.2,.1) #weighing coefficient
d = c(1,4,4,7,6,7,7,14,15,20) #m
K = 1000/sqrt(9.81*d) #
I = c(100,120,140,150,150,160,130,120,110,100) #m3/s
delt = 1 #day
Q = 100
t = c(1,2,3,4,5,6,7,8,9,10)
# i = seq(100,1000, by=100)
C1 = (delt-2*K*X)/(2*K*(1-X)+delt)
C2 = (delt+2*K*X)/(2*K*(1-X)+delt)
C3 = (2*K*(1-X)-delt)/(2*K*(1-X)+delt)
Q = matrix(100, nrow=10, ncol=10)
Q[,1]= I
for (i in 1:9) {
for (j in 1:9) {
Q[i+1,j+1]=C1[i]*Q[i,j+1]+C2[i]*Q[i,j]+C3[i]*Q[i+1,j]
}
}
Q
X = c(.1,.2,.1,.4,.5,.1,.1,.1,.2,.1) #weighing coefficient
d = c(1,4,4,7,6,7,7,14,15,20) #m
K = 100/sqrt(9.81*d) #
I = c(100,120,140,150,150,160,130,120,110,100) #m3/s
delt = 1 #day
Q = 100
t = c(1,2,3,4,5,6,7,8,9,10)
# i = seq(100,1000, by=100)
C1 = (delt-2*K*X)/(2*K*(1-X)+delt)
C2 = (delt+2*K*X)/(2*K*(1-X)+delt)
C3 = (2*K*(1-X)-delt)/(2*K*(1-X)+delt)
Q = matrix(100, nrow=10, ncol=10)
Q[,1]= I
for (i in 1:9) {
for (j in 1:9) {
Q[i+1,j+1]=C1[i]*Q[i,j+1]+C2[i]*Q[i,j]+C3[i]*Q[i+1,j]
}
}
Q
source("~/Documents/senior_year/hydrology/HW6_3.R", echo=TRUE)
Q
plot(Q)[,1]
plot(1:10,Q[,1])
plot(1:10,Q[,1])
lines(1:10,Q[,2])
plot(1:10,Q[,1],type="l")
lines(1:10,Q[,2])
plot(1:10,Q[,1],type="l", col="red")
lines(1:10,Q[,2])
plot(1:10,Q[,3],type="l", col="red")
lines(1:10,Q[,4])
plot(1:10,Q[,1],type="l", col="red")
lines(1:10,Q[,2])
plot(1:10,Q[,5],type="l", col="red")
lines(1:10,Q[,6])
plot(1:10,Q[,9],type="l", col="red")
lines(1:10,Q[,10])
plot(1:10,Q[,7],type="l", col="red")
lines(1:10,Q[,8])
plot(1:10,Q[,9],type="l", col="red")
lines(1:10,Q[,10])
plot(1:10,Q[,7],type="l", col="red")
lines(1:10,Q[,8])
plot(1:10,Q[,9],type="l", col="red")
lines(1:10,Q[,10])
plot(1:10,Q[,7],type="l", col="red")
lines(1:10,Q[,8])
source("~/Documents/senior_year/hydrology/HW6.R", echo=TRUE)
p1
source("~/Documents/senior_year/hydrology/HW6_3.R", echo=TRUE)
Q
C1
C2
C3
source("~/Documents/senior_year/hydrology/HW6_3.R", echo=TRUE)
Q
source("~/Documents/senior_year/hydrology/HW6.R", echo=TRUE)
p1
source("~/Documents/senior_year/hydrology/HW6.R", echo=TRUE)
p1
source("~/Documents/senior_year/hydrology/HW6.R", echo=TRUE)
p1
source("~/Documents/senior_year/hydrology/HW6.R", echo=TRUE)
p1
source("~/Documents/senior_year/hydrology/HW6.R", echo=TRUE)
p1
source("~/Documents/senior_year/hydrology/HW6.R", echo=TRUE)
p1
source("~/Documents/senior_year/hydrology/HW6.R", echo=TRUE)
p1
source("~/Documents/senior_year/hydrology/HW6.R", echo=TRUE)
p1
source("~/Documents/senior_year/hydrology/HW6.R", echo=TRUE)
source("C:/Users/ncw02/Downloads/IGEA/ts_scripts/load_12.R", echo=TRUE)
View(ts1_excel)
View(ts1_hr_df)
input1_file=paste0('raw_ts_data/group12/',reach_ID,'_ts1.txt')
raw1_text=readLines(con=input1_file) #read every line
index1_1=grep("END SETUP",raw1_text) #ts1 start of section
index1_2=grep("END SLOPE",raw1_text) #ts1 end of section
ts1_hr_df= read.delim(input1_file,
header = TRUE, skip = index1_1, nrows= (index1_2-index1_1-2), dec = ".", sep = ',')%>%
rename("PointID"="TgtID")%>%
rename("HR"="RefHt")%>%
filter(PointID = '101')
input1_file=paste0('raw_ts_data/group12/',reach_ID,'_ts1.txt')
raw1_text=readLines(con=input1_file) #read every line
index1_1=grep("END SETUP",raw1_text) #ts1 start of section
index1_2=grep("END SLOPE",raw1_text) #ts1 end of section
ts1_hr_df= read.delim(input1_file,
header = TRUE, skip = index1_1, nrows= (index1_2-index1_1-2), dec = ".", sep = ',')%>%
rename("PointID"="TgtID")%>%
rename("HR"="RefHt")%>%
filter(PointID == '101')
input2_file=paste0('raw_ts_data/group12/',reach_ID,'_ts2.txt')
raw2_text=readLines(con=input2_file) #read every line
index2_1=grep("END SETUP",raw2_text) #ts2 start of section
index2_2=grep("END SLOPE",raw2_text) #ts2 end of section
ts2_hr_df= read.delim(input2_file,
header = TRUE, skip = index2_1, nrows= (index2_2-index2_1-2), dec = ".", sep = ',')%>%
rename("PointID"="TgtID")%>%
rename("HR"="RefHt")%>%
filter(PointID == '101')
ts1_txt = read.delim(paste0('raw_ts_data/group12.n/',reach_ID,'_ts1.txt'),
skip = 1, header = TRUE, dec = ".", sep = ',')%>%
mutate(TS_code = "1")%>%
mutate(Reach = ts1_reach$Reach)%>%
mutate(PointID = as.double(PointID))%>%
mutate(HR=ts1_hr_df$HR)
View(ts1_txt)
ts1_txt = read.delim(paste0('raw_ts_data/group12.n/',reach_ID,'_ts1.txt'),
skip = 1, header = TRUE, dec = ".", sep = ',')%>%
mutate(TS_code = "1")%>%
mutate(Reach = ts1_reach$Reach)%>%
mutate(PointID = as.double(PointID))%>%
mutate(HR=ts1_hr_df$HR)%>%
filter(PointID != '101')%>%
filter(!is.na(PointID))
ts2_txt = read.delim(paste0('raw_ts_data/group12.n/',reach_ID,'_ts2.txt'),
skip = 1, header = TRUE, dec = ".", sep = ',')%>%
mutate(TS_code = "2")%>%
mutate(Reach = ts2_reach$Reach)%>%
mutate(PointID = as.double(PointID))%>%
mutate(HR=ts2_hr_df$HR)%>%
filter(PointID != '101')%>%
filter(!is.na(PointID))
source("C:/Users/ncw02/Downloads/IGEA/ts_scripts/load_12.R", echo=TRUE)
View(ts2_reach)
View(ts1_reach)
View(ts1_hr_df)
ts1_txt = read.delim(paste0('raw_ts_data/group12.n/',reach_ID,'_ts1.txt'),
skip = 1, header = TRUE, dec = ".", sep = ',')%>%
mutate(TS_code = "1")%>%
mutate(Reach = ts1_reach$Reach)%>%
mutate(PointID = as.double(PointID))%>%
filter(PointID != '101')%>%
filter(!is.na(PointID))%>%
mutate(HR=ts1_hr_df$HR)
ts2_txt = read.delim(paste0('raw_ts_data/group12.n/',reach_ID,'_ts2.txt'),
skip = 1, header = TRUE, dec = ".", sep = ',')%>%
mutate(TS_code = "2")%>%
mutate(Reach = ts2_reach$Reach)%>%
mutate(PointID = as.double(PointID))%>%
filter(PointID != '101')%>%
filter(!is.na(PointID))%>%
mutate(HR=ts2_hr_df$HR)
View(ts1_txt)
View(ts2_txt)
# manual intervention to get rid of PT 101 which was being problematic
ts1_txt = ts1_txt[2:nrow(ts1_txt),]
ts2_txt = ts2_txt[2:nrow(ts2_txt),]
#----
# JOIN DATA FRAMES ----
reach_ID = toupper(reach_ID)
# this joins excel (digitized data) with metadata for ts1
joined_df1 = left_join(ts1_excel, metadata_excel, by='Reach')%>%
filter(Reach == reach_ID)
# this joins excel (digitized data) with metadata for ts2
joined_df2 = left_join(ts2_excel, metadata_excel, by='Reach')%>%
filter(Reach == reach_ID)
# this joins the previous file with txt file data
joined_df3 = left_join(joined_df1, ts1_txt, by=c('Reach','PointID','TS_code'))
joined_df4 = left_join(joined_df2, ts2_txt, by=c('Reach','PointID','TS_code'))%>%
mutate(ERRORCODE=ifelse(is.na(ERRORCODE),0,ERRORCODE))
# this joins both ts1 and ts2 data to complete the entire reach
# creates a unique ID and another unique ID without A's and P's
master_df = rbind(joined_df3, joined_df4)%>%
mutate(uniqueID = paste0(Reach, PointID, Location, Cross.section, TS_code))%>%
mutate(LRW = substr(uniqueID,8,8))%>%
mutate(Type = substr(uniqueID,9,9))%>%
mutate(Number = substr(uniqueID,10,10))%>%
mutate(UID2 = paste0(Reach, LRW, Number, Cross.section, TS_code))%>%
mutate(Elevation = as.double(str_remove_all(Elevation, ' ')))%>%
mutate(newelev=ifelse(ERRORCODE==2,Elevation + (HR-ADJUSTMENT),Elevation))%>% #adjustment for HR change if errorcode is 2
filter(ERRORCODE!="8")
# ----
# SEPARATE A's & P's  ----
a_df = select(master_df, UID2, Cross.section, LRW, Type, Number, Elevation)%>%
filter(Type == 'A')%>%
rename("Active" = "Type")%>%
rename("ElevationA" = "newelev")
source("C:/Users/ncw02/Downloads/IGEA/ts_scripts/load_12.R", echo=TRUE)
View(alt_df)
